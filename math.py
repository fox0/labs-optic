#!/usr/bin/env python3
import math
import logging

log = logging.getLogger(__name__)

result1 = [0.45457393483709274, 0.14066416040100252, 0.18734335839598998, 0.18107769423558898, 0.2236842105263158,
           0.22180451127819548, 0.16290726817042606, 0.11967418546365914, 0.1425438596491228, 0.19329573934837094,
           0.13174019607843138, 0.24571078431372548, 0.13664215686274508, 0.09681372549019608, 0.16482843137254902,
           0.19301470588235295, 0.11151960784313726, 0.19362745098039216, 0.2659313725490196, 0.3180147058823529]
result2 = [0.45958646616541354, 0.5955513784461153, 0.5303884711779449, 0.5200501253132832, 0.28884711779448624,
           0.28728070175438597, 0.2741228070175439, 0.32863408521303256, 0.45144110275689225, 0.5081453634085213,
           0.6776960784313726, 0.22487745098039216, 0.5716911764705882, 0.4074754901960784, 0.3314950980392157,
           0.24142156862745098, 0.5747549019607843, 0.5814950980392157, 0.5006127450980392, 0.2855392156862745]
result3 = [0.041040100250626564, 0.1588345864661654, 0.20708020050125314, 0.20206766917293234, 0.4342105263157895,
           0.3925438596491228, 0.4718045112781955, 0.4282581453634085, 0.2973057644110276, 0.18452380952380953,
           0.11458333333333333, 0.3939950980392157, 0.20098039215686275, 0.39889705882352944, 0.38174019607843135,
           0.42401960784313725, 0.22549019607843138, 0.08946078431372549, 0.11029411764705882, 0.20526960784313725]

STUDENT_T = {
    # alpha, m (n-1)
    (0.05, 19): 2.093,
    (0.05, 20): 2.086,
}


def main():
    for i, ls in enumerate((result1, result2, result3)):
        log.info('Фаза %d' % (i + 1))

        n = len(ls)
        log.info('Объём выборки = %d' % n)
        x_avr = sum(ls) / n
        log.info('2. Среднее выборочное аифметическое = %.3f' % x_avr)

        s_x2 = sum((x_i - x_avr) ** 2 for x_i in ls) / (n - 1)
        log.info('3. Выборочная дисперсия = %.3f' % s_x2)

        s_x = math.sqrt(s_x2)
        log.info('4. Выборочное среднее квадратичное отклонение = %.3f' % s_x)

        v = s_x / x_avr * 100
        log.info('5. Выборочный коэффициент вариации = %.3f%%' % v)

        # 6. доверительный интервал
        # матожидание
        m_x = x_avr  # todo

        alpha = 0.05
        m = n - 1
        t = STUDENT_T[(alpha, m)]
        log.debug('%.3f < %.3f < %.3f', x_avr - t * s_x / math.sqrt(n), m_x, x_avr + t * s_x / math.sqrt(n))
        log.info('6. ')

        # 7. Проверка по критерию Смирнова


        log.info('----')


if __name__ == '__main__':
    logging.basicConfig(format='%(asctime)s [%(levelname)s] %(funcName)s:%(name)s:%(lineno)d: %(message)s',
                        level=logging.DEBUG)
    main()
